---
tags: vaje, kirv, lfsr, shannon
hackmd: https://hackmd.io/73gHVgn-TYWScyNk4sEvUA
plugins: mathjax
---
# Cryptography and computer security - Tutorial 3.11.2020

---

## Block ciphers

| Substitution-permutation network | Feistel cipher |
| - | - |
| ![SPN](https://upload.wikimedia.org/wikipedia/commons/thumb/c/cd/SubstitutionPermutationNetwork2.png/360px-SubstitutionPermutationNetwork2.png) | ![Feistel cipher](https://upload.wikimedia.org/wikipedia/commons/thumb/f/fa/Feistel_cipher_diagram_en.svg/511px-Feistel_cipher_diagram_en.svg.png) |

### Exercise 1

Let <i>$y$</i> be the output of a SPN on input <i>$x$</i>, where <i>$\ell=m=N_r=4$</i>, and permutations <i>$\pi_S$</i> and <i>$\pi_P$</i> be defined as

| <i>$z$</i> | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | A | B | C | D | E | F |
| ---------- | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - | - |
| <i>$\pi_S(z)$</i> | E | 4 | D | 1 | 2 | F | B | 8 | 3 | A | 6 | C | 5 | 9 | 0 | 7 |

and

| <i>$z$</i> | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 | 15 | 16 |
| ---------- | - | - | - | - | - | - | - | - | - | -- | -- | -- | -- | -- | -- | -- |
<i>$\pi_P(z)$</i> | 1 | 5 | 9 | 1 | 2 | 6 | 1 | 14 | 3 | 7 | 11 | 15 | 4 | 8 | 12 | 16

Suppose that the round key <i>$K_1 = {\tt 0x3954}$</i> is given in a hexadecimal notation. Compute one round of the SPN for the plaintext <i>$x = {\tt 0x295C}$</i>.

---

### Exercise 2

Consider a <i>$2$</i>-round Feistel network with encryption function <i>$f(R, K) = R \oplus K$</i>. Assume that all subkeys are equal, i.e., <i>$K = K_0 = K_1 = K_2$</i>, with subkey size being half the block size. Show that this cipher is not secure.

---

### Exercise 3

Prove that decryption in a Feistel cipher can be done by applying the encryption algorithm to the ciphertext with the key schedule reversed.

---

## Attacks on block ciphers

### Exercise 4

Since DES has too short keys (<i>$56$</i> bits), we decide to combine DES with XOR to achieve <i>$120$</i>-bit encryption. We pick a <i>$56$</i>-bit key <i>$k_1$</i> for regular DES and a <i>$64$</i>-bit key $k_2$. To encrypt a block <i>$m$</i>, we first encrypt it using DES and then XOR the result with the second key. Mathematically, our encryption scheme is:

$$
\text{DESX}_{k_1, k_2}(m) = \text{DES}_{k_1}(m) \oplus k_2 .
$$

Show that DESX is not much secure than basic DES,
as far as exhaustive key search goes.

---

### Exercise 5

We now look at the following variant of key whitening with DES. Suppose that the message <i>$m$</i> and the keys <i>$k_1$</i> and <i>$k_2$</i> are <i>$56$</i> bits long. The encryption is defined as

$$
\text{DESW}_{k_1, k_2}(m) = \text{DES}_{k_2}(m \oplus k_1)
$$

Show that breaking DESW is roughly as difficult as a brute force attack against single DES.

---

### Exercise 6

Suppose that we encrypt a message <i>$m$</i> in three DES rounds:

$$
c = \text{DES}_{k_3}(\text{DES}_{k_2}^{-1}(\text{DES}_{k_1}(m))) .
$$

When does this scheme reduce to single DES?

---

## [Modes of operation](https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Confidentiality_only_modes)

### Exercise 7

For each mode of operation, give the mathematical expression of the decryption and draw the corresponding block diagram.

---

### Exercise 8

For which modes of operation does <i>$E_k(m \oplus x) = E_k(m) \oplus x$</i> hold?

---

### Exercise 9

Which modes of operation allow random access to the ciphertext blocks? That is, if the recipient has the information <i>$(i, c_i)$</i>, can they decrypt the message $m_i$ without having any other ciphertext blocks? If not, what additional information do they need?

---

### Exercise 10

Suppose an attacker changes one block of the ciphertext <i>$c_i$</i> into <i>$c'_i \not= c_i$</i>. Which blocks are then decrypted incorrectly when using ECB, CBC, CFB, OFB and CTR modes?
